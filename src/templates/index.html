<body>
    <h1>Outi LaTeX Viitteidenhallinta</h1>

    <h2>Lisää uusi viite</h2>

    <form action="/show_fields" method="get">
        <div>
            <label>Viitetyyppi:</label><br>
            <select name="type" required onchange="this.form.submit()">
                <option value="">Valitse tyyppi...</option>
                {% for ref_type in reference_types %}
                <option value="{{ ref_type }}" {% if ref_type == selected_type %}selected{% endif %}>
                    {{ ref_type }}
                </option>
                {% endfor %}
            </select>
        </div>
    </form>

    {% if selected_type and fields %}
    <hr>
    <h3>{{ selected_type }} -viitteen kentät</h3>

    <form>
        <div>
            <label>Viiteavain*:</label><br>
            <input type="text" name="cite_key" required>
        </div>

        {% for field in fields %}
        <div>
            <label>
                {{ field.key }}{% if field.required %} *{% endif %}
                {% if field.additional %}<small>(lisäkenttä)</small>{% endif %}:
            </label><br>

            {% if field['input-type'] == 'textarea' %}
            <textarea name="{{ field.key }}" rows="3" style="width: 300px;"
                      {% if field.required %}required{% endif %}></textarea>
            {% elif field['input-type'] == 'number' or field.type == 'int' %}
            <input type="number" name="{{ field.key }}"
                   {% if field.required %}required{% endif %}>
            {% else %}
            <input type="text" name="{{ field.key }}"
                   {% if field.required %}required{% endif %}>
            {% endif %}
        </div>
        {% endfor %}

        <br>
        <button type="submit">Tallenna</button>
    </form>
    {% endif %}
</body>
</html>